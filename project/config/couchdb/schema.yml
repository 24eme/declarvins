acVinCompte:
  type: abstract
  definition:
    fields:
      login: { }
      mot_de_passe: {  }
      email: {  }
      statut: {  }
      droits:
        type: array_collection
        definition:
          fields:
            '*': { }

_Compte:
  inheritance: acVinCompte
  type: abstract
  definition:
    fields:
      login: { }

acVinCompteTiers:
  inheritance: _Compte
  definition:
    fields:
      _id: {  }
      _rev: {  }
      tiers:
        type: collection
        definition:
          fields:
            '*':
              type: collection
              definition:
                fields:
                  id: {  }
                  type: {  }
                  nom: {  }
                  interpro: {  }

acVinCompteVirtuel:
  inheritance: _Compte
  definition:
    fields:
      _id: {  }
      _rev: {  }
      type: {  }
      nom: {  }
      commune: {  }
      code_postal: {  }

CompteTiers:
  inheritance: acVinCompteTiers
  definition:
    fields:
      nom: {  }
      prenom: {  }
      fonction: {  }
      telephone: {  }
      fax: {  }
      type: {  }
      contrat: {  }
      interpro: 
        type: collection
        definition:
          fields:
            '*':
              type: collection
              definition:
                fields:
                  statut: {  }

CompteVirtuel:
  inheritance: acVinCompteVirtuel
  definition:
    fields:
      interpro: {  }
      prenom: {  }
      telephone: {  }
      fax: {  }

Interpro:
  definition:
    fields:
      _id: {  }
      _rev: {  }
      identifiant: { }
      nom: { }
      type: {  }
      statut: {  }

Etablissement:
  definition:
    fields:
      _id: {  }
      _rev: {  }
      identifiant: { }
      nom: { }
      type: {  }
      statut: {  }
      interpro: {  }
      compte: {  }
      droits:
        type: array_collection
        definition:
          fields:
            '*': {  }
      num_interne: {  }
      siret: {  }
      raison_sociale: {  }
      nom: {  }
      cni: {  }
      cvi: {  }
      no_accises: {  }
      no_tva_intracommunautaire: {  }
      famille: {  }
      sous_famille: {  }
      email: {  }
      telephone: {  }
      fax: {  }
      siege:
          type: collection
          definition:
            fields:
              adresse: {  }
              code_postal: {  }
              commune: {  }
      comptabilite:
          type: collection
          definition:
            fields:
              adresse: {  }
              code_postal: {  }
              commune: {  }
      service_douane: {  }

Douane:
  definition:
    fields:
      _id: {  }
      _rev: {  }
      identifiant: { }
      nom: { }
      type: {  }
      statut: {  }
      email: {  }

Contrat:
  definition:
    fields:
      _id: {  }
      _rev: {  }
      no_contrat: {  }
      type: {  }
      nom: {  }
      prenom: {  }
      fonction: {  }
      telephone: {  }
      fax: {  }
      compte: {  }
      email: {  }
      etablissements:
        type: array_collection
        definition:
          fields:
            '*':
              type: collection
              definition:
                fields:
                  raison_sociale: {  }
                  nom: {  }
                  siret: {  }
                  cni: {  }
                  cvi: {  }
                  no_accises: {  }
                  no_tva_intracommunautaire: {  }
                  adresse: {  }
                  code_postal: {  }
                  commune: {  }
                  telephone: {  }
                  fax: {  }
                  email: {  }
                  famille: {  }
                  sous_famille: {  }
                  comptabilite_adresse: {  }
                  comptabilite_code_postal: {  }
                  comptabilite_commune: {  }
                  service_douane: {  }
                  edi: {  }

#Vrac:
#  definition:
#    fields:
#      _id: {  }
#      _rev: {  }
#      type: {  }
#      produit: {  }
#      numero: {  }
#      actif: {  }
#      date_creation: {  }
#      annee: {  }
#      mois: {  }
#      acheteur:
#        type: collection
#        definition:
#          fields:
#            nom: {  }
#      courtier:
#        type: collection
#        definition:
#          fields:
#            nom: {  }
#      etablissement: {  }
#      prix: { type: float }
#      volume_promis: { type: float }
#      volume_realise: { type: float }
# Vrac pour les contrats
#Vrac:
#  definition:
#    fields:
#      _id: {  }
#      _rev: { }
#      type: { }
#      numero_contrat: {  }
#      etape: { type: integer }           
#Soussigné (Part 1)
#      vendeur_famille: {  }  
#      vendeur_identifiant: {  }      
#      vendeur:        
#        type: collection
#        definition:
#          fields:            
#            nom: {  }
#            cvi: {  }
#            num_accise: {   }
#            num_tva_intracomm: {    }
#            adresse: {  }
#            commune: {  }
#            code_postal: {   }
#            departement: {   }
#      acheteur_famille: {  } 
#      acheteur_identifiant: {  }     
#      acheteur:
#        type: collection
#        definition:
#          fields:
#            nom: {  }
#            cvi: {  }
#            num_accise: {   }
#            num_tva_intracomm: {    }
#            adresse: {  }
#            commune: {  }
#            code_postal: {   }
#            departement: {   }
#      mandataire_exist: {   }
#      mandatant: 
#        type: array_collection
#        definition:
#          fields:
#            '*': {  }
#      mandataire_identifiant: {  }     
#      mandataire:
#        type: collection
#        definition:
#          fields:
#            nom: {  }
#            carte_pro: {  }
#            adresse: {  }               
#Marché (Part 2)
#      original: { type: integer }            
#      type_transaction: {  }
#      produit: {   }
#      millesime: { type: integer }
#      domaine: {  }
#      label:
#        type: array_collection
#       definition:
#          fields:
#            '*': {  }      
      #Pour le raisin (en kg)
#      raisin_quantite: { type: float }
      #Pour les mouts et pour le vin en vrac (en hl)
#      jus_quantite: { type: float }
      #Pour le vin en bouteilles (nb bouteille)
#      bouteilles_quantite: { type: float }
#      bouteilles_contenance: { type: float }
#      prix_unitaire: { type: float }
#      prix_total: { type: float }         
#Conditions (Part 3)
#      type_contrat: {   }
#      prix_variable: { type: integer }
      # prix_variable = true
#      part_variable: { type: float }
#      taux_variation: { type: float }
#      cvo_nature: { }
      #cvo_repartition float ou string? "50/50" ou 0.5
#      cvo_repartition: { }        
#Validations
#      date_stats: { }
#      date_signature: { }
#      volume_propose: { type: float }
#      volume_enleve: { type: float }     
#      valide:
#        type: collection
#        definition:
#          fields:
            # les vues de date_stats/date_signature dans part3
#            date_saisie: {  }
#            identifiant: {  }
#            statut: { }
Vrac:
  definition:
    fields:
      _id: {  }
      _rev: {  }
      type: {  }
      numero_contrat: {  }
      etape: {  }
      vendeur_type: {  }  
      vendeur_identifiant: {  }      
      vendeur:        
        type: collection
        definition:
          fields:            
            nom: {  }
            raison_sociale: {  }
            siret: {  }
            cvi: {  }
            num_accise: {   }
            num_tva_intracomm: {    }
            adresse: {  }
            code_postal: {  }
            commune: {  }
            telephone: {  }
            fax: {  }
            email: {   }
      vendeur_tva: {  }
      adresse_stockage:
        type: collection
        definition:
          fields:
            adresse: {  }
            code_postal: {  }
            commune: {  }
      acheteur_type: {  }  
      acheteur_identifiant: {  }      
      acheteur:        
        type: collection
        definition:
          fields:            
            nom: {  }
            raison_sociale: {  }
            siret: {  }
            cvi: {  }
            num_accise: {   }
            num_tva_intracomm: {    }
            adresse: {  }
            code_postal: {  }
            commune: {  }
            telephone: {  }
            fax: {  }
            email: {   }
      acheteur_tva: {  }
      adresse_livraison:
        type: collection
        definition:
          fields:
            adresse: {  }
            code_postal: {  }
            commune: {  }
      mandataire_exist: {  }
      mandatant: 
        type: array_collection
        definition:
          fields:
            '*': {  }
      mandataire_identifiant: {  }     
      mandataire:
        type: collection
        definition:
          fields:
            nom: {  }
            raison_sociale: {  }
            siret: {  }
            carte_pro: {  }
            adresse: {  }
            code_postal: {  }
            commune: {  }
            telephone: {  }
            fax: {  }
            email: {  }
      premiere_mise_en_marche: {  }
      production_otna: {  }
      apport_union: {  }
      cession_interne: {  }
      original: {  }
      type_transaction: {  }
      produit: {  }
      contient_domaine: {  }
      domaine: {  }
      labels:
        type: array_collection
        definition:
          fields:
            '*': {  }
      mentions:
        type: array_collection
        definition:
          fields:
            '*': {  }
      volume_propose: {  }
      annexe: {  }
      prix_unitaire: {  }
      type_prix: {  }
      determination_prix: {  }
      date_limite_retiraison: {  }
      commentaires_conditions: {  }
      part_cvo: {  }
      prix_total: {  }
      conditions_paiement:
        type: array_collection
        definition:
          fields:
            '*': {  }
      type_echeancier_paiement: {  }
      vin_livre: {  }
      date_debut_retiraison: {  }
      calendrier_retiraison: {  }
      retiraisons:
        type: array_collection
        definition:
          fields:
            '*':
              type: collection
              definition:
                fields:
                  lot_cuve: {  }
                  date_retiraison: {  }
                  volume_retire: {  }
                  montant_paiement: {  }
      contrat_pluriannuel: {  }
      reference_contrat_pluriannuel: {  }
      delai_paiement: {  }
      echeancier_paiement: {  }
      paiements:
        type: array_collection
        definition:
          fields:
            '*':
              type: collection
              definition:
                fields:
                  date: {  }
                  montant: {  }
      clause_reserve_retiraison: {  }
      export: {  }
      lots:
        type: array_collection
        definition:
          fields:
            '*':
              type: collection
              definition:
                fields:
                  numero: {  }
                  contenance_cuve: {  }
                  millesime: {  }
                  pourcentage_annee: {  }
                  degre: {  }
                  presence_allergenes: {  }
                  raisin_quantite: {  }
                  jus_quantite: {  }
                  bouteilles_quantite: {  }
                  bouteilles_contenance_volume: {  }
                  bouteilles_contenance_libelle: {  }
                  volume: {  }
                  date_retiraison: {  }
                  commentaires: {  }
                  metayage:
                    type: collection
                    definition:
                      fields:
                        bailleur: {  }
                        volume_ventillation: {  }
      type_contrat: {  }
      prix_variable: {  }
      part_variable: {  }
      cvo_nature: {  }
      cvo_repartition: {  }
      date_stats: {  }
      date_signature: {  }
      volume_enleve: {  }
      valide:
        type: collection
        definition:
          fields:
            date_saisie: {  }
            identifiant: {  }
            statut: { }
      nature_document: {  }
      date_signature_vendeur: {  }
      date_signature_acheteur: {  }
      date_signature_mandataire: {  }
      commentaires: {  }

Current:
  definition:
    fields:
      _id: {  }
      _rev: {  }
      type: {  }
      campagne: {  }

Configuration:
  definition:
    fields:
      _id: {  }
      _rev: {  }
      type: {  }
      campagne: {  }
      vrac:
        type: collection
        definition:
          fields:
            interpro:
              type: collection
              definition:
                fields:
                  '*':
                    class: ConfigurationVrac
                    type: collection
                    definition:
                      fields:
                        vendeur_types:
                          type: collection
                          definition:
                            fields:
                              '*': {  }
                        acheteur_types:
                          type: collection
                          definition:
                            fields:
                              '*': {  }
                        types_transaction:
                          type: collection
                          definition:
                            fields:
                              '*': {  }
                        labels:
                          type: collection
                          definition:
                            fields:
                              '*': {  }
                        mentions:
                          type: collection
                          definition:
                            fields:
                              '*': {  }
                        types_prix:
                          type: collection
                          definition:
                            fields:
                              '*': {  }
                        conditions_paiement:
                          type: collection
                          definition:
                            fields:
                              '*': {  }
                        types_contrat:
                          type: collection
                          definition:
                            fields:
                              '*': {  }
                        cvo_natures:
                          type: collection
                          definition:
                            fields:
                              '*': {  }
                        cvo_repartitions:
                          type: collection
                          definition:
                            fields:
                              '*': {  }
                        natures_document:
                          type: collection
                          definition:
                            fields:
                              '*': {  }
                        types_domaine:
                          type: collection
                          definition:
                            fields:
                              '*': {  }
                        delais_paiement:
                          type: collection
                          definition:
                            fields:
                              '*': {  }
      droits:
        type: collection
        definition:
          fields:
            '*': {  }
      libelle_detail_ligne:
        type: collection
        definition:
          fields:
            stocks_debut:
              type: collection
              definition:
                fields:
                  '*': {  }
            entrees:
              type: collection
              definition:
                fields:
                  '*': {  }
            sorties:
              type: collection
              definition:
                fields:
                  '*': {  }
            stocks_fin:
              type: collection
              definition:
                fields:
                  '*': {  }
      declaration:
        type: collection
        definition:
          fields:
            certifications:
              type: collection
              definition:
                fields:
                  '*':
                    # CERTIFICATION
                    class: ConfigurationCertification
                    inheritance: _ConfigurationDeclaration
                    type: collection
                    definition:
                      fields:
                        libelle: {  }
                        code: {  }
                        departements:
                          type: array_collection
                          definition:
                            fields:
                              '*': {  }
                        interpro:
                          type: collection
                          definition:
                            fields:
                              '*':
                                type: collection
                                definition:
                                  fields:
                                    labels:
                                      type: array_collection
                                      definition:
                                        fields:
                                          '*': {  }
                                    droits:
                                      type: collection
                                      definition:
                                        fields:
                                          douane:
                                            class: ConfigurationDroits
                                            type: array_collection
                                            definition:
                                              fields:
                                                '*':
                                                  class: ConfigurationDroit
                                                  type: collection
                                                  definition:
                                                    fields:
                                                      date: {  }
                                                      taux: { type: float }
                                                      code: {  }
                                                      libelle: {  }
                                          cvo:
                                            class: ConfigurationDroits
                                            type: array_collection
                                            definition:
                                              fields:
                                                '*':
                                                  class: ConfigurationDroit
                                                  type: collection
                                                  definition:
                                                    fields:
                                                      date: {  }
                                                      taux: { type: float }
                                                      code: {  }
                                                      libelle: {  }
                        genres:
                          type: collection
                          definition:
                            fields:
                              '*':
                                # GENRE
                                class: ConfigurationGenre
                                inheritance: _ConfigurationDeclaration
                                type: collection
                                definition:
                                  fields:
                                    libelle: {  }
                                    code: {  }
                                    detail:
                                      required: false
                                      class: ConfigurationDetail
                                      type: collection
                                      definition:
                                        fields:
                                          stocks_debut:
                                            required: false
                                            type: collection
                                            definition:
                                              fields:
                                                '*':
                                                  class: ConfigurationDetailLigne
                                                  type: collection
                                                  definition:
                                                    fields:
                                                      readable: {  }
                                                      writable: {  }
                                          entrees:
                                            required: false
                                            type: collection
                                            definition:
                                              fields:
                                                '*':
                                                  class: ConfigurationDetailLigne
                                                  type: collection
                                                  definition:
                                                    fields:
                                                      readable: {  }
                                                      writable: {  }
                                          sorties:
                                            required: false
                                            type: collection
                                            definition:
                                              fields:
                                                '*':
                                                  class: ConfigurationDetailLigne
                                                  type: collection
                                                  definition:
                                                    fields:
                                                      readable: {  }
                                                      writable: {  }
                                          stocks_fin:
                                            required: false
                                            type: collection
                                            definition:
                                              fields:
                                                '*':
                                                  class: ConfigurationDetailLigne
                                                  type: collection
                                                  definition:
                                                    fields:
                                                      readable: {  }
                                                      writable: {  }
                                    interpro:
                                      type: collection
                                      definition:
                                        fields:
                                          '*':
                                            type: collection
                                            definition:
                                              fields:
                                                labels:
                                                  type: array_collection
                                                  definition:
                                                    fields:
                                                      '*': {  }
                                                droits:
                                                  type: collection
                                                  definition:
                                                    fields:
                                                      douane:
                                                        class: ConfigurationDroits
                                                        type: array_collection
                                                        definition:
                                                          fields:
                                                            '*':
                                                              class: ConfigurationDroit
                                                              type: collection
                                                              definition:
                                                                fields:
                                                                  date: {  }
                                                                  taux: { type: float }
                                                                  code: {  }
                                                                  libelle: {  }
                                                      cvo:
                                                        class: ConfigurationDroits
                                                        type: array_collection
                                                        definition:
                                                          fields:
                                                            '*':
                                                              class: ConfigurationDroit
                                                              type: collection
                                                              definition:
                                                                fields:
                                                                  date: {  }
                                                                  taux: { type: float }
                                                                  code: {  }
                                                                  libelle: {  }
                                    departements:
                                      type: array_collection
                                      definition:
                                        fields:
                                          '*': {  }
                                    appellations:
                                      type: collection
                                      definition:
                                        fields:
                                          '*':
                                            # APPELLATION
                                            class: ConfigurationAppellation
                                            inheritance: _ConfigurationDeclaration
                                            type: collection
                                            definition:
                                              fields:
                                                libelle: {  }
                                                code: {  }
                                                detail:
                                                  required: false
                                                  class: ConfigurationDetail
                                                  type: collection
                                                  definition:
                                                    fields:
                                                      stocks_debut:
                                                        required: false
                                                        type: collection
                                                        definition:
                                                          fields:
                                                            '*':
                                                              class: ConfigurationDetailLigne
                                                              type: collection
                                                              definition:
                                                                fields:
                                                                  readable: {  }
                                                                  writable: {  }
                                                      entrees:
                                                        required: false
                                                        type: collection
                                                        definition:
                                                          fields:
                                                            '*':
                                                              class: ConfigurationDetailLigne
                                                              type: collection
                                                              definition:
                                                                fields:
                                                                  readable: {  }
                                                                  writable: {  }
                                                      sorties:
                                                        required: false
                                                        type: collection
                                                        definition:
                                                          fields:
                                                            '*':
                                                              class: ConfigurationDetailLigne
                                                              type: collection
                                                              definition:
                                                                fields:
                                                                  readable: {  }
                                                                  writable: {  }
                                                      stocks_fin:
                                                        required: false
                                                        type: collection
                                                        definition:
                                                          fields:
                                                            '*':
                                                              class: ConfigurationDetailLigne
                                                              type: collection
                                                              definition:
                                                                fields:
                                                                  readable: {  }
                                                                  writable: {  }
                                                interpro:
                                                  type: collection
                                                  definition:
                                                    fields:
                                                      '*':
                                                        type: collection
                                                        definition:
                                                          fields:
                                                            labels:
                                                              type: array_collection
                                                              definition:
                                                                fields:
                                                                  '*': {  }
                                                            droits:
                                                              type: collection
                                                              definition:
                                                                fields:
                                                                  douane:
                                                                    class: ConfigurationDroits
                                                                    type: array_collection
                                                                    definition:
                                                                      fields:
                                                                        '*':
                                                                          class: ConfigurationDroit
                                                                          type: collection
                                                                          definition:
                                                                            fields:
                                                                              date: {  }
                                                                              taux: { type: float }
                                                                              code: {  }
                                                                              libelle: {  }
                                                                  cvo:
                                                                    class: ConfigurationDroits
                                                                    type: array_collection
                                                                    definition:
                                                                      fields:
                                                                        '*':
                                                                          class: ConfigurationDroit
                                                                          type: collection
                                                                          definition:
                                                                            fields:
                                                                              date: {  }
                                                                              taux: { type: float }
                                                                              code: {  }
                                                                              libelle: {  }
                                                departements:
                                                  type: array_collection
                                                  definition:
                                                    fields:
                                                      '*': {  }
                                                mentions:
                                                  type: collection
                                                  definition:
                                                    fields:
                                                      '*':
                                                        # MENTION
                                                        class: ConfigurationMention
                                                        inheritance: _ConfigurationDeclaration
                                                        type: collection
                                                        definition:
                                                          fields:
                                                            libelle: {  }
                                                            code: {  }
                                                            departements:
                                                              type: array_collection
                                                              definition:
                                                                fields:
                                                                  '*': {  }
                                                            lieux:
                                                              type: collection
                                                              definition:
                                                                fields:
                                                                  '*':
                                                                    # LIEU
                                                                    class: ConfigurationLieu
                                                                    inheritance: _ConfigurationDeclaration
                                                                    type: collection
                                                                    definition:
                                                                      fields:
                                                                        libelle: {  }
                                                                        code: {  }
                                                                        departements:
                                                                          type: array_collection
                                                                          definition:
                                                                            fields:
                                                                              '*': {  }
                                                                        detail:
                                                                          required: false
                                                                          class: ConfigurationDetail
                                                                          type: collection
                                                                          definition:
                                                                            fields:
                                                                              stocks_debut:
                                                                                required: false
                                                                                type: collection
                                                                                definition:
                                                                                  fields:
                                                                                    '*':
                                                                                      class: ConfigurationDetailLigne
                                                                                      type: collection
                                                                                      definition:
                                                                                        fields:
                                                                                          readable: {  }
                                                                                          writable: {  }
                                                                              entrees:
                                                                                required: false
                                                                                type: collection
                                                                                definition:
                                                                                  fields:
                                                                                    '*':
                                                                                      class: ConfigurationDetailLigne
                                                                                      type: collection
                                                                                      definition:
                                                                                        fields:
                                                                                          readable: {  }
                                                                                          writable: {  }
                                                                              sorties:
                                                                                required: false
                                                                                type: collection
                                                                                definition:
                                                                                  fields:
                                                                                    '*':
                                                                                      class: ConfigurationDetailLigne
                                                                                      type: collection
                                                                                      definition:
                                                                                        fields:
                                                                                          readable: {  }
                                                                                          writable: {  }
                                                                              stocks_fin:
                                                                                required: false
                                                                                type: collection
                                                                                definition:
                                                                                  fields:
                                                                                    '*':
                                                                                      class: ConfigurationDetailLigne
                                                                                      type: collection
                                                                                      definition:
                                                                                        fields:
                                                                                          readable: {  }
                                                                                          writable: {  }
                                                                                    departements:
                                                                                      type: array_collection
                                                                                      definition:
                                                                                        fields:
                                                                                          '*': {  }
                                                                        couleurs: 
                                                                          type: collection
                                                                          definition:
                                                                            fields:
                                                                              '*':
                                                                                # COULEUR
                                                                                class: ConfigurationCouleur
                                                                                inheritance: _ConfigurationDeclaration
                                                                                type: collection
                                                                                definition:
                                                                                  fields:
                                                                                    libelle: {  }
                                                                                    code: {  }
                                                                                    cepages: 
                                                                                      type: collection
                                                                                      definition:
                                                                                        fields:
                                                                                          '*':
                                                                                            # CEPAGE
                                                                                            class: ConfigurationCepage
                                                                                            inheritance: _ConfigurationDeclaration
                                                                                            type: collection
                                                                                            definition:
                                                                                              fields:
                                                                                                libelle: {  }
                                                                                                code: {  }
                        detail:
                          class: ConfigurationDetail
                          type: collection
                          definition:
                            fields:
                              stocks_debut:
                                type: collection
                                definition:
                                  fields:
                                    '*':
                                      class: ConfigurationDetailLigne
                                      type: collection
                                      definition:
                                        fields:
                                          readable: {  }
                                          writable: {  }
                              entrees:
                                type: collection
                                definition:
                                  fields:
                                    '*':
                                      class: ConfigurationDetailLigne
                                      type: collection
                                      definition:
                                        fields:
                                          readable: {  }
                                          writable: {  }
                              sorties:
                                type: collection
                                definition:
                                  fields:
                                    '*':
                                      class: ConfigurationDetailLigne
                                      type: collection
                                      definition:
                                        fields:
                                          readable: {  }
                                          writable: {  }
                              stocks_fin:
                                type: collection
                                definition:
                                  fields:
                                    '*':
                                      class: ConfigurationDetailLigne
                                      type: collection
                                      definition:
                                        fields:
                                          readable: {  }
                                          writable: {  }

Messages:
  definition:
    fields:
      _id: {  }
      _rev: {  }
      type: {}
      '*': {}
Controles:
  definition:
    fields:
      _id: {  }
      _rev: {  }
      type: {}
      '*': {}
